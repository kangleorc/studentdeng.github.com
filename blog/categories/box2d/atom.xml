<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: box2D | studentdeng Blog]]></title>
  <link href="http://studentdeng.github.com/blog/categories/box2d/atom.xml" rel="self"/>
  <link href="http://studentdeng.github.com/"/>
  <updated>2013-07-20T14:02:53+08:00</updated>
  <id>http://studentdeng.github.com/</id>
  <author>
    <name><![CDATA[studentdeng]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[box2d 03 b2Joint 连接器]]></title>
    <link href="http://studentdeng.github.com/blog/2013/07/20/box2d-03/"/>
    <updated>2013-07-20T13:30:00+08:00</updated>
    <id>http://studentdeng.github.com/blog/2013/07/20/box2d-03</id>
    <content type="html"><![CDATA[<p>在真实世界中，一个物体很难孤立的存在，比如一个我们的自行车，2个轮子除了可以自由滚动以外，还必须保证2个轮子之间的距离不变，而保证这个距离不变的就是自行车的大梁。我们的胳膊，需要保证在一定范围的情况下围绕一个点旋转等等。Box2D中 连接器就是用来保证刚体和刚体之间的某种关系而出现的。</p>

<p>我们先认识b2DistanceJoint——距离连接器。</p>

<p><img src="http://www.ladeng6666.com/blog/wp-content/uploads/2012/08/zixingche.jpg" alt="image" /></p>

<p>这是一个自行车的模型bodyA bodyB 就是之前熟悉的圆形刚体，中间的红线是我们的距离连接，anchorA，anchorB 则是连接器连接2个刚体的位置。非常的直观。</p>

<pre><code>b2DistanceJointDef jointDef;
jointDef.Initialize(ballA, ballB, ballA-&gt;GetPosition(), ballB-&gt;GetPosition());

b2DistanceJoint *join = (b2DistanceJoint *)world-&gt;CreateJoint(&amp;jointDef);
CGFloat distance = 30.0 / PTM_RATIO;
join-&gt;SetLength(distance);
</code></pre>

<p>非常的直观，制定连接的位置和距离，就创建完毕了。下面是一个demo，每当触摸屏幕的时候给自行车一个向右的冲量。</p>

<p><a href="https://github.com/studentdeng/box2d-tutorials/tree/master/03">demo代码</a></p>

<p><a href="http://v.youku.com/v_show/id_XNTg1MjU2MTQ4.html">demo演示</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Box2D 02 刚体]]></title>
    <link href="http://studentdeng.github.com/blog/2013/07/19/box2d-02/"/>
    <updated>2013-07-19T15:30:00+08:00</updated>
    <id>http://studentdeng.github.com/blog/2013/07/19/box2d-02</id>
    <content type="html"><![CDATA[<p>刚体的属性有3种。</p>

<ul>
<li>staticBody</li>
<li>kinematicBody</li>
<li><p>dynamicBody</p>

<p>  staticzero mass, zero velocity, may be manually moved</p>

<p>  kinematic: zero mass, non-zero velocity set by user, moved by solver</p>

<p>  dynamic: positive mass, non-zero velocity determined by forces, moved by solver</p></li>
</ul>


<p>简单说就是static 的刚体没有质量，没有速度。
kinematic 的刚体没有质量，但是可以设置速度。
dynamic 的刚体就是之前我们写的小球。有质量有速度。</p>

<p>static 的常常用于游戏中的墙，这种不会移动的，而且不会受到力的作用改变他的位置，速度等。
kinematic 的常常用于游戏中的跳板这些，他们会移动，但是同样不会受到力的作用改变原来的运动轨迹。
dynamic 通常是我们的玩家，敌人。他们会移动，而且会受到力的作用，旋转，碰撞，加速等。</p>

<p>刚写好了几个demo，用来做这几种类型的区分，</p>

<p><a href="https://github.com/studentdeng/box2d-tutorials/tree/master/02">demo代码</a>
<a href="http://v.youku.com/v_show/id_XNTg0OTM0OTg4.html">demo演示</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Box2D 01 基本概念]]></title>
    <link href="http://studentdeng.github.com/blog/2013/07/18/box2d-01/"/>
    <updated>2013-07-18T16:05:00+08:00</updated>
    <id>http://studentdeng.github.com/blog/2013/07/18/box2d-01</id>
    <content type="html"><![CDATA[<p>首先几个概念需要了解一下。</p>

<p><strong>world</strong>
就是engin需要模拟的世界，他有一个大家都很熟悉的重力</p>

<p><strong>body(刚体)</strong>
刚体的定义大家在物理中都熟悉了，在box2D世界中，刚体定义了物体一些重要的属性，比如质点位置，旋转角度，角速度，线性阻尼，等</p>

<p><strong>shape(形状)</strong>这里定义我们的物体的形状是圆的，方的还是多边形等</p>

<p><strong>fixture(材质？这个好难翻译中文)</strong>光是上面的东西，我们不能够完成物理世界的碰撞，fixture定义了几个重要的属性，包括摩擦系数，恢复系数，密度</p>

<p>回想当初学习的物理知识也就这么多了，当然后面还会介绍其他新的东西。有个形状，和密度我们可以计算质量，有了位置，速度，角速度，足够我们计算高中学到的简单碰撞了，在有恢复系数和线性阻尼，我们也能更好的模拟更真实的物理情景，而这也是大学物理的部分了。</p>

<p>好多的背景知识，让我们再看看如何在程序里面做一个真实的世界出来。</p>

<pre><code>b2Vec2 gravity;
gravity.Set(0.0f, -10.0f);
world = new b2World(gravity);
</code></pre>

<p>box2D的坐标是和笛卡尔坐标系一样的，向量 (0, -10) 表示我们真实世界的重力，大约为10米每秒</p>

<p>创建我们的第一个物体，一个圆球。
这里Box2D采用了工厂模式来创建一个我们需要的物体。我们首先描述一个需求，然后通过一个工厂来生产我们需要的产品。</p>

<pre><code>b2BodyDef bodyDef;//
bodyDef.type = b2_dynamicBody; //这里定义为动态刚体
bodyDef.position.Set(pt.x/PTM_RATIO, pt.y/PTM_RATIO);
body = world-&gt;CreateBody(&amp;bodyDef);

b2CircleShape bodyShape;
bodyShape.m_radius = 26.0 / PTM_RATIO; //定义球的半径

b2FixtureDef fixtureDef;
fixtureDef.shape = &amp;bodyShape;
fixtureDef.density = 0.1f;  //密度
fixtureDef.friction = 0.1f; //摩擦力
fixtureDef.restitution = 0.9f; //恢复系数
body-&gt;CreateFixture(&amp;fixtureDef);
</code></pre>

<p>还急得之前的概念么？在定义好body，shape，创建好fixture之后。这些信息已经足够模拟真实运动了。因为是真实的世界，独立各个平台，box2D的单位是米，而不是程序图形图像的单位像素，PTM_RATIO这个宏用于转换单位。</p>

<p>当然，这些物理数据还不能让我们在程序中看到，为了美观，增加一点小东西，希望大家了解cocos2d。这里创建一个CCPhysicsSprite</p>

<pre><code>CCPhysicsSprite *sprite = [CCPhysicsSprite spriteWithFile:@"ball.png"];
[self addChild:sprite];

[sprite setPTMRatio:PTM_RATIO];
[sprite setB2Body:body];

//CCPhysicsSprite 的操作一定要在设置PTMRatio 和 body之后
[sprite setPosition: ccp(pt.x, pt.y)];
</code></pre>

<p>这时我们就可以看到一个小球自由落体，然后淡出世界，不过似乎有一种淡淡的忧伤，太无趣了这个世界。</p>

<p>让我们为这个世界创建一个边界，让小球不要运动超过屏幕。</p>

<pre><code>// Define the ground body.
b2BodyDef groundBodyDef;
groundBodyDef.position.Set(0, 0); // bottom-left corner

// Call the body factory which allocates memory for the ground body
// from a pool and creates the ground box shape (also from a pool).
// The body is also added to the world.
b2Body* groundBody = world-&gt;CreateBody(&amp;groundBodyDef);

// Define the ground box shape.
b2EdgeShape groundBox;      

// bottom

groundBox.Set(b2Vec2(0,0), b2Vec2(s.width/PTM_RATIO,0));
groundBody-&gt;CreateFixture(&amp;groundBox,0);

// top
groundBox.Set(b2Vec2(0,s.height/PTM_RATIO), b2Vec2(s.width/PTM_RATIO,s.height/PTM_RATIO));
groundBody-&gt;CreateFixture(&amp;groundBox,0);

// left
groundBox.Set(b2Vec2(0,s.height/PTM_RATIO), b2Vec2(0,0));
groundBody-&gt;CreateFixture(&amp;groundBox,0);

// right
groundBox.Set(b2Vec2(s.width/PTM_RATIO,s.height/PTM_RATIO), b2Vec2(s.width/PTM_RATIO,0));
groundBody-&gt;CreateFixture(&amp;groundBox,0);
</code></pre>

<p>这里没有指定其他属性，默认创建的刚体是静态的，不会移动的。而这正是我们想要的。</p>

<p>这时小球会自由落体然后反弹，这时可以调整restitution，如果对这些不是很熟悉的话。但是总体感觉还是有一点无聊，让我们再来一点新东西。</p>

<pre><code>b2Vec2 force = b2Vec2(-30, 30);
body-&gt;ApplyLinearImpulse(force, body-&gt;GetPosition());
</code></pre>

<p>body是我们其中的一个小球。ApplyLinearImpulse的意思就是对body施加一个冲量。</p>

<p><a href="https://github.com/studentdeng/box2d-tutorials/tree/master/01">demo地址</a></p>

<p><a href="http://v.youku.com/v_show/id_XNTg0NTU4NzQ0.html">demo演示地址</a></p>
]]></content>
  </entry>
  
</feed>
